The Semi-Lagrangian Scheme in centred difference was proposed by \cite{sawyer1963} for atmospheric flow numerical simulation using vorticity-advection equation, allowing to use large time steps without numerical instability. 
However, because of a limited computer capability, the use of such methodology to model several fluid flow problems, with high order differences and fine mesh, came latter in the 1980's throught the work of \cite{robert1981} and \cite{pironneau1982}, where the semi-lagrangian scheme would be able to run models faster than the Eulerian scheme, besides be unconditionally stable and only symmetric linear systems to solve. 
Basically, the semi-lagrangian scheme takes into account the fact that the Eulerian derivative is replaced by the material derivative, then it is discretized and computed along the trajectory characteristic:

\vspace{-0.4cm}
\begin{equation}
 \frac{\partial \omega}{\partial t} + \mathbf{v} \cdot \nabla \omega = 
 \frac{D \omega}{D t} = 
 \frac{\omega_{i}^{n+1} - \omega_{d}^{n}}{\Delta t}
\end{equation}

\noindent
where, 
the left-hand side equation is the Eulerian derivative,
$D\omega/Dt$ is material derivative and
the right-hand side equation is material derivative discretized using first order backward difference scheme.
The variable $t$ is time, 
$\omega_{i}^{n+1}$ is the vorticity field calculated in current time step at the current node position and
$\omega_{d}^{n}$ is the vorticity field calculated in previous time step at the departure node position.

\smallskip
The departure node is found by solving equation 
$\mathbf{x}_{d}^{n} = \mathbf{x}_{i}^{n+1} - \mathbf{v} \Delta t$, 
using the initial condition $\mathbf{x}_{i}^{n+1} = \mathbf{x}(t^{n+1})$
 as shown in \ref{semi-lagrangian figure}a. 
A algorithm must be used to find the element that the departure node be, 
then the vorticity field in departure node ($\omega_{d}^{n}$) is 
calculed by barycenter coordinates interpolation between nodes of 
element found.
As shown in \ref{semi-lagrangian figure}b, three situations may 
occur depending on the trajectory: the first and the second 
situations are similar, differentiating only the trajectory length. 
In the first situation, the departure node is inside near 
element from current node, while the second situation 
the departure node is inside far element from current node. 
The third situation, the departure node is outside domain 
then the vorticity field in departure node receives the 
boundary condition value of nearest node to departure node.

\begin{figure}[H]
\begin{center}

\begin{tikzpicture}[scale=4]

 % FIGURE A
 % grid
 \draw (0.5,0.7) -- (2.0,0.7);
 \draw (0.5,1.0) -- (2.0,1.0);
 \draw (0.5,1.2) -- (2.0,1.2);

 % material points
 \draw[dashed] (0.8,0.7) -- (1.12,1.0);
 \node[square, fill=white, draw, inner sep=0pt, minimum size=9.4pt] at (0.8,0.7) {};
 \node[square, fill=white, draw, inner sep=0pt, minimum size=9.4pt] at (1.12,1.0) {};
 

 % nodes
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (0.60,0.7) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (1.20,0.7) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (1.54,0.7) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (1.85,0.7) {};

 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (0.64,1.0) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (1.12,1.0) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (1.64,1.0) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (1.90,1.0) {};

 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (0.60,1.2) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (1.10,1.2) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (1.50,1.2) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (1.90,1.2) {};


 % legend
 \node[draw=none, scale=1.0] at (0.80,0.82) {\small $\mathbf{x}_{d}$};
 \node[draw=none, scale=1.0] at (1.22,0.88) {\small $\mathbf{x}_{i}$};

 \node[draw=none, scale=1.0] at (2.10,0.70) {\small $t^{n}$};
 \node[draw=none, scale=1.0] at (2.15,1.00) {\small $t^{n+1}$};
 \node[draw=none, scale=1.0] at (2.15,1.20) {\small $t^{n+2}$};

 \node[draw=none, scale=1.0] at (0.60,0.55) {\small $\mathbf{x}_{i-1}$};
 \node[draw=none, scale=1.0] at (1.22,0.55) {\small $\mathbf{x}_{i}$};
 \node[draw=none, scale=1.0] at (1.64,0.55) {\small $\mathbf{x}_{i+1}$};


 % -------------------------------------------------------------------
 % FIGURE B
 % boundary 
 \draw (2.5,1.6) -- (4.0,1.6);
 \draw (2.5,1.6) -- (2.5,0.5);
 \draw (2.5,0.5) -- (4.0,0.5);

 % nodes
 \coordinate (A) at (2.500,0.5000) {};
 \coordinate (B) at (2.500,0.8667) {};
 \coordinate (C) at (2.500,1.2330) {};
 \coordinate (D) at (2.500,1.6000) {};
 \coordinate (E) at (2.733,0.6830) {};
 \coordinate (F) at (2.833,1.0500) {};
 \coordinate (G) at (2.733,1.4160) {};
 \coordinate (H) at (3.000,1.6000) {};
 \coordinate (I) at (3.066,0.5000) {};
 \coordinate (J) at (3.166,0.8660) {};
 \coordinate (K) at (3.150,1.3330) {};
 \coordinate (L) at (3.333,1.6000) {};
 \coordinate (M) at (3.500,0.5000) {};
 \coordinate (N) at (3.333,0.6830) {};
 \coordinate (O) at (3.400,1.0000) {};
 \coordinate (P) at (3.500,1.2300) {};

 % elements
 \draw (A) -- (E) -- (B) -- cycle;
 \draw (A) -- (I) -- (E) -- cycle;
 \draw (E) -- (J) -- (F) -- cycle;
 \draw (E) -- (F) -- (B) -- cycle;
 \draw (B) -- (F) -- (C) -- cycle;
 \draw (J) -- (K) -- (F) -- cycle;
 \draw (F) -- (K) -- (G) -- cycle;
 \draw (C) -- (F) -- (G) -- cycle;
 \draw (C) -- (G) -- (D) -- cycle;
 \draw (G) -- (H) -- (D) -- cycle;
 \draw (I) -- (N) -- (J) -- cycle;
 \draw (I) -- (M) -- (N) -- cycle;
 \draw (N) -- (O) -- (J) -- cycle;
 \draw (J) -- (O) -- (K) -- cycle;
 \draw (P) -- (L) -- (K) -- cycle;
 \draw (K) -- (L) -- (H) -- cycle;
 \draw (O) -- (P) -- (K) -- cycle;
 \draw[red,line width=0.04cm] (I) -- (J) -- (E) -- cycle;
 \draw[red,line width=0.04cm] (B) -- (C);
 \draw[red,line width=0.04cm] (G) -- (K) -- (H) -- cycle;
 

 % draw nodes
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (A) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (B) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (C) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (D) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (E) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (F) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (G) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (H) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (I) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (J) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (K) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (L) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (M) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (N) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (O) {};
 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (P) {};


 % arrow
 \draw[dashed,line width=0.03cm] (J) edge (2.95,0.65);
 \draw[dashed,line width=0.03cm] (J) edge (2.90,1.45);
 \draw[dashed,line width=0.03cm] (J) edge (2.4,1.05) ;

 \node[circle, fill=black, inner sep=0pt, minimum size=5.2pt] at (J) {};

 % departure nodes
 \node[circle, fill=white, draw, inner sep=0pt, minimum size=5.2pt] at (2.95,0.65) {};
 \node[circle, fill=white, draw, inner sep=0pt, minimum size=5.2pt] at (2.90,1.45) {};
 \node[circle, fill=white, draw, inner sep=0pt, minimum size=5.2pt] at (2.4,1.05) {};


 
 % legend
 \node[draw=none, scale=0.9] at (3.23,0.97) {\small $\omega_{i}$};
 
 \node[draw=none, scale=0.9] at (3.05,0.64) {$1$};
 \node[draw=none, scale=0.9] at (3.00,1.45) {$2$};
 \node[draw=none, scale=0.9] at (2.4,1.15) {$3$};

 \node[draw=none, scale=1.0] at (3.7,1.0) {\small $domain$};
 \node[draw=none, scale=1.0] at (3.8,1.65) {\small $boundary$};



 \node[draw=none, scale=0.8] at (1.23,0.3) {\large (a)};
 \node[draw=none, scale=0.8] at (3.25,0.3) {\large (b)};

\end{tikzpicture}
\end{center}
\caption{In (a), an one-dimensional space scheme
 where the departure node $x_{d}$ is found by integrating the 
mesh backward time. In (b), a two-dimensional space scheme
where three situations may occur in searching procedure.}
\label{semi-lagrangian figure}
\end{figure}


\medskip
Therefore, the Eqs. 
\ref{vorticity matrix},
\ref{stream matrix} and
\ref{concentrarion matrix} 
can be shown 
in an
implicit semi-Lagragian 
discretization as:

\begin{equation}
 M \left[ \frac{\omega^{n+1}_{i} - \omega^{n}_{d}}{\Delta t} \right] 
 + \frac{1}{\textit{Re}} \left[ K_{xx} + K_{yy} \right] \omega^{n+1}_{i}
 = 0
\end{equation}

\begin{equation}
 - \left[ K_{xx} + K_{yy} \right] \psi + M \omega = 0
\end{equation}

\begin{equation}
 M \left[ \frac{e^{n+1}_{i} - e^{n}_{d}}{\Delta t} \right]
 + \frac{1}{\textit{ReSc}} \left[ K_{xx} + K_{yy} \right] e^{n+1}_{i}
 = 0
\end{equation}


\medskip
\noindent
that is,

\begin{equation}
 \frac{M}{\Delta t} \omega^{n+1}_{i}
 + \frac{1}{\textit{Re}} \left[ K_{xx} + K_{yy} \right] \omega^{n+1}_{i}
 = \frac{M}{\Delta t} \omega^{n}_{d}
\end{equation}

\begin{equation}
 \left[ K_{xx} + K_{yy} \right] \psi 
 =  M \omega
\end{equation}

\begin{equation}
 \frac{M}{\Delta t} e^{n+1}_{i}
 + \frac{1}{\textit{ReSc}} \left[ K_{xx} + K_{yy} \right] e^{n+1}_{i}
 = \frac{M}{\Delta t} e^{n}_{d}
\end{equation}


\medskip
Therefore, the Vorticity-Streamfunction Formulation with
Species Transport Equation discretized by \textit{Galerkin}
and \textit{semi-Lagrangian Methods} in an ALE-FE context
can be presented in matrix form as:

\begin{equation}
 \left[
 \frac{M}{\Delta t} 
 + \frac{1}{\textit{Re}} \left[ K_{xx} + K_{yy} \right]
 \right] 
 \omega^{n+1}_{i}
 = \frac{M}{\Delta t} \omega^{n}_{d}
\end{equation}

\begin{equation}
 \left[ K_{xx} + K_{yy} \right] \psi 
 =  M \omega
\end{equation}

\begin{equation}
 \left[
 \frac{M}{\Delta t} 
 + \frac{1}{\textit{ReSc}} \left[ K_{xx} + K_{yy} \right]
 \right] 
 e^{n+1}_{i}
 = \frac{M}{\Delta t} e^{n}_{d}
\end{equation}

\medskip
\noindent
whereas material velocity field \textbf{v} is calculated by:
$u =   G_{y} \psi$ and 
$v = - G_{x} \psi$, 
where 
$G_{y}$ and 
$G_{x}$ are the \textit{Gradient global matrix}.
 

