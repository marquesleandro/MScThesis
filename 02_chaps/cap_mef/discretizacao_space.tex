The weight functions $\delta$, $\phi$ and $\eta$ 
are sets of arbitrary functions and it have a large number of choices. 
In this work to discretize the domain, we will use the 
\textbf{Galerkin Method} which considers the same shape functions 
for the weight and interpolation functions of the unknowns 
($w$, $\psi$, $e$). 
Thus, Eqs. \ref{vorticity weak}, \ref{stream weak} and
 \ref{concentration weak} 
can be presented in expanded form such as:

\begin{equation} 
   \int_{\Omega} \frac{D \omega}{Dt} \delta d\Omega 
 + \frac{1}{\textit{Re}} \int_{\Omega} \Bigg\{ \frac{\partial \omega}{\partial x} \frac{\partial \delta}{\partial x} 
 + \frac{\partial \omega}{\partial y} \frac{\partial \delta}{\partial y} \Bigg\} d\Omega 
 = 0
\end{equation}

\begin{equation}
 - \int_{\Omega} \Bigg\{ \frac{\partial \psi}{\partial x} \frac{\partial \phi}{\partial x} 
 + \frac{\partial \psi}{\partial y} \frac{\partial \phi}{\partial y} \Bigg\} d\Omega
 + \int_{\Omega} \omega \phi d\Omega = 0
\end{equation}

\begin{equation} 
   \int_{\Omega} \frac{D e}{Dt} \eta d\Omega 
 + \frac{1}{\textit{ReSc}} \int_{\Omega} \Bigg\{ \frac{\partial e}{\partial x} \frac{\partial \eta}{\partial x} 
 + \frac{\partial e}{\partial y} \frac{\partial \eta}{\partial y} \Bigg\} d\Omega
 = 0
\end{equation}

\medskip
We will now discretize the domain in \textit{ne} elements and 
\textit{np} nodes, where \textit{ne} represents the total number 
of elements and \textit{np} the total number of nodes 
in the computational mesh. Thus, we have:

\begin{align}
 \omega(\textbf{x},t) & \simeq \sum\limits_{i=1}^{np} \omega_i(t) N_i(\textbf{x}) \\
 \psi(\textbf{x},t) & \simeq \sum\limits_{i=1}^{np} \psi_i(t) N_i(\textbf{x}) \\
 e(\textbf{x},t) & \simeq \sum\limits_{i=1}^{np} e_i(t) N_i(\textbf{x})
\end{align}

\noindent
where 
$\omega_i = [\omega_1,...,\omega_{np}]$,
$\psi_i = [\psi_1,...,\psi_{np}]$ and
$e_i = [c_1,...,c_{np}]$ 
are the semi-discrete unknowns, that is, 
these unknowns are continuous in time ($t$)
and discrete in space ($\textbf{x}$). As they
are only time dependent, then 
they can leave the integrals on the domain 
$\Omega$. In addition, $N_i = [N_1, ..., N_{np}]$ 
are the approximation functions known 
as basis functions or interpolation functions. 
These functions can be chosen arbitrarily, however they 
must respect the boundary conditions. 
They vary depending on the element type used for discretization. 
As mentioned, in this work we will use the same type of element 
for each governing equation, 
so we will have the same basis functions for all equations.


\medskip
In Galerkin formulation, the weight functions assume 
the values of the basis functions, that is:

\begin{align}
 \delta(\textbf{x},t) & \simeq \sum\limits_{j=1}^{np} \delta_j(t) N_j(\textbf{x}) \\
 \phi(\textbf{x},t) & \simeq \sum\limits_{j=1}^{np} \phi_j(t) N_j(\textbf{x}) \\
 \eta(\textbf{x},t) & \simeq \sum\limits_{j=1}^{np} \eta_j(t) N_j(\textbf{x})
\end{align}

\noindent
Thus, the governing equations in variational form 
discretized in space will be:

\begin{equation} \label{convection vorticity}
 \begin{aligned} 
  \int_{\Omega} \sum\limits_{i=1}^{np} \frac{D \omega_i}{Dt} N_i 
                \sum\limits_{j=1}^{np} & \delta_j N_j d\Omega 
  \\[5pt]
  + & \frac{1}{\textit{Re}} \int_{\Omega} \Bigg\{ 
                    \sum\limits_{i=1}^{np} \frac{\partial \omega_i N_i}{\partial x} 
                    \sum\limits_{j=1}^{np} \frac{\partial \delta_j N_j}{\partial x} 
  +                 \sum\limits_{i=1}^{np} \frac{\partial \omega_i N_i}{\partial y} 
                    \sum\limits_{j=1}^{np} \frac{\partial \delta_j N_j}{\partial y} \Bigg\}
 = 0
 \end{aligned}
\end{equation}

\begin{equation}
 \begin{aligned}
  - \int_{\Omega} \Bigg\{ 
                  \sum\limits_{i=1}^{np} \frac{\partial \psi_i N_i}{\partial x} 
                  \sum\limits_{j=1}^{np} \frac{\partial \phi_j N_j}{\partial x} 
  +               \sum\limits_{i=1}^{np} \frac{\partial \psi_i N_i}{\partial y} 
                  \sum\limits_{j=1}^{np} & \frac{\partial \phi_j N_j}{\partial y} 
  \Bigg\} d\Omega 
  \\[5pt]
  & + \int_{\Omega} \sum\limits_{i=1}^{np} \omega_i N_i 
                  \sum\limits_{j=1}^{np} \phi_j N_j d\Omega = 0
 \end{aligned}
\end{equation}

\begin{equation} \label{convection concentration}
 \begin{aligned} 
  \int_{\Omega} \sum\limits_{i=1}^{np} \frac{D e_i}{Dt} N_i 
                \sum\limits_{j=1}^{np} & \eta_j N_j d\Omega 
  \\[5pt]
  + & \frac{1}{\textit{ReSc}} \int_{\Omega} \Bigg\{ 
                    \sum\limits_{i=1}^{np} \frac{\partial e_i N_i}{\partial x} 
                    \sum\limits_{j=1}^{np} \frac{\partial \eta_j N_j}{\partial x} 
  +                 \sum\limits_{i=1}^{np} \frac{\partial e_i N_i}{\partial y} 
                    \sum\limits_{j=1}^{np} \frac{\partial \eta_j N_j}{\partial y} \Bigg\} d\Omega
 = 0
 \end{aligned}
\end{equation}

\medksip
\noindent
Moving the sum symbols out of integrals, we have:

\begin{equation}
 \begin{aligned} 
  \sum\limits_{j=1}^{np} \delta_j \Bigg[
  \sum\limits_{i=1}^{np} \frac{D \omega_i}{Dt} 
  \int_{\Omega} N_i N_j d\Omega & 
  \\[5pt]
   + & \sum\limits_{i=1}^{np} \omega_i \Bigg[
   + \frac{1}{\textit{Re}} i
   \int_{\Omega} \Bigg\{ 
   \frac{\partial N_i}{\partial x} 
   \frac{\partial N_j}{\partial x} 
   + 
   \frac{\partial N_i}{\partial y} 
   \frac{\partial N_j}{\partial y} 
   \Bigg\} d\Omega
 \Bigg] \Bigg] = 0
 \end{aligned}
\end{equation}

\begin{equation}
  \sum\limits_{j=1}^{np} \phi_j \Bigg[
  \sum\limits_{i=1}^{np} \psi_i \Bigg[
  - \int_{\Omega} \Bigg\{ 
                  \frac{\partial N_i}{\partial x} 
                  \frac{\partial N_j}{\partial x} 
  +               \frac{\partial N_i}{\partial y} 
                  \frac{\partial N_j}{\partial y} 
  \Bigg\} d\Omega
  + \omega_i \int_{\Omega} N_i N_j d\Omega
  \Bigg] \Bigg] = 0
\end{equation}

\begin{equation}
 \begin{aligned} 
  \sum\limits_{j=1}^{np} \eta_j \Bigg[
  \sum\limits_{i=1}^{np} \frac{D e_i}{Dt} 
  \int_{\Omega} N_i N_j d\Omega & 
  \\[5pt]
   + & \sum\limits_{i=1}^{np} e_i \Bigg[
   + \frac{1}{\textit{ReSc}} 
   \int_{\Omega} \Bigg\{ 
   \frac{\partial N_i}{\partial x} 
   \frac{\partial N_j}{\partial x} 
   + 
   \frac{\partial N_i}{\partial y} 
   \frac{\partial N_j}{\partial y} 
   \Bigg\} d\Omega
 \Bigg] \Bigg] = 0
 \end{aligned}
\end{equation}


\noindent
Taking into account that
$\sum\limits_{j=1}^{np} \delta_j \neq 0$,
$\sum\limits_{j=1}^{np} \phi_j \neq 0$ and
$\sum\limits_{j=1}^{np} \eta_j \neq 0$,
thus the governing equations become:

\begin{equation}
  \sum\limits_{j=1}^{np}
  \sum\limits_{i=1}^{np} \frac{D \omega_i}{Dt} 
  \int_{\Omega} N_i N_j d\Omega 
   + \sum\limits_{i=1}^{np} \omega_i \Bigg[
   + \frac{1}{\textit{Re}} i
   \int_{\Omega} \Bigg\{ 
   \frac{\partial N_i}{\partial x} 
   \frac{\partial N_j}{\partial x} 
   + 
   \frac{\partial N_i}{\partial y} 
   \frac{\partial N_j}{\partial y} 
   \Bigg\} d\Omega
 \Bigg] \Bigg] = 0
\end{equation}

\begin{equation}
  \sum\limits_{j=1}^{np}
  \sum\limits_{i=1}^{np} \psi_i \Bigg[
  - \int_{\Omega} \Bigg\{ 
                  \frac{\partial N_i}{\partial x} 
                  \frac{\partial N_j}{\partial x} 
  +               \frac{\partial N_i}{\partial y} 
                  \frac{\partial N_j}{\partial y} 
  \Bigg\} d\Omega
  + \omega_i \int_{\Omega} N_i N_j d\Omega
  \Bigg] \Bigg] = 0
\end{equation}

\begin{equation}
  \sum\limits_{j=1}^{np}
  \sum\limits_{i=1}^{np} \frac{D e_i}{Dt} 
  \int_{\Omega} N_i N_j d\Omega & 
   + \sum\limits_{i=1}^{np} e_i \Bigg[
   + \frac{1}{\textit{ReSc}} 
   \int_{\Omega} \Bigg\{ 
   \frac{\partial N_i}{\partial x} 
   \frac{\partial N_j}{\partial x} 
   + 
   \frac{\partial N_i}{\partial y} 
   \frac{\partial N_j}{\partial y} 
   \Bigg\} d\Omega
 \Bigg] \Bigg] = 0
\end{equation}



\noindent
that is:

\begin{equation} \label{vorticity pre matrix}
 \begin{aligned} 
  \sum\limits_{j=1}^{np} 
  \sum\limits_{i=1}^{np} \overset{.}{\omega_i} \int_{\Omega} N_i N_j d\Omega 
  + \sum\limits_{j=1}^{np} 
    \sum\limits_{i=1}^{np} \omega_i \Bigg[
  & u \int_{\Omega}  \frac{\partial N_i}{\partial x} N_j d\Omega 
  + v \int_{\Omega} \frac{\partial N_i}{\partial y} N_j d\Omega
  \\[5pt]
  + \frac{1}{\textit{Re}} \int_{\Omega} \Bigg\{ 
                    \frac{\partial N_i}{\partial x} 
                    \frac{\partial N_j}{\partial x} 
  +                 \frac{\partial N_i}{\partial y} 
                    \frac{\partial N_j}{\partial y} 
  \Bigg\} d\Omega 
 & + \frac{\Delta t}{2} \int_{\Omega} u
 \Bigg[
   u \frac{\partial N_j}{\partial x} \frac{\partial N_i}{\partial x}
 + v \frac{\partial N_j}{\partial x} \frac{\partial N_i}{\partial y}
 \Bigg] d\Omega
 \\[5pt]
 & + \frac{\Delta t}{2} \int_{\Omega} v
 \Bigg[
   u \frac{\partial N_j}{\partial y} \frac{\partial N_i}{\partial x}
 + v \frac{\partial N_j}{\partial y} \frac{\partial N_i}{\partial y}
 \Bigg] d\Omega
  \Bigg] = 0
 \end{aligned}
\end{equation}

\begin{equation}
 \begin{aligned}
  \sum\limits_{j=1}^{np}
  \sum\limits_{i=1}^{np} \psi_i \Bigg[
  - \int_{\Omega} \Bigg\{ 
                  \frac{\partial N_i}{\partial x} 
                  \frac{\partial N_j}{\partial x} 
  +               \frac{\partial N_i}{\partial y} 
                  \frac{\partial N_j}{\partial y} 
  \Bigg\} d\Omega
  + \omega_i \int_{\Omega} N_i N_j d\Omega
  \Bigg] = 0
 \end{aligned}
\end{equation}

\begin{equation}
 \begin{aligned}
  \sum\limits_{j=1}^{np}
  \sum\limits_{i=1}^{np} u_i \Bigg[
   \int_{\Omega} N_i N_j d\Omega
 - \psi_i \int_{\Omega} \frac{\partial N_i}{\partial y} N_j d\Omega
  \Bigg] = 0
 \end{aligned}
\end{equation}

\begin{equation}
 \begin{aligned}
  \sum\limits_{j=1}^{np}
  \sum\limits_{i=1}^{np} v_i \Bigg[
   \int_{\Omega} N_i N_j d\Omega
 + \psi_i \int_{\Omega} \frac{\partial N_i}{\partial x} N_j d\Omega
  \Bigg] = 0
 \end{aligned}
\end{equation}

\begin{equation} \label{concentration pre matrix}
\begin{aligned} 
 \sum\limits_{j=1}^{np}
 \sum\limits_{i=1}^{np} \overset{.}{c_i} \int_{\Omega} N_i N_j d\Omega 
  + \sum\limits_{j=1}^{np}
    \sum\limits_{i=1}^{np} c_i  \Bigg[
    u \int_{\Omega} & \frac{\partial N_i}{\partial x} N_j d\Omega 
  + v \int_{\Omega} \frac{\partial N_i}{\partial y} N_j d\Omega
  \\[5pt]
  + \frac{1}{\textit{ReSc}} \int_{\Omega} \Bigg\{ 
                    \frac{\partial N_i}{\partial x} 
                    \frac{\partial N_j}{\partial x} 
  +                 \frac{\partial N_i}{\partial y} 
                    \frac{\partial N_j}{\partial y} 
  \Bigg\} d\Omega 
 & + \frac{\Delta t}{2} \int_{\Omega} u
 \Bigg[
   u \frac{\partial N_j}{\partial x} \frac{\partial N_i}{\partial x}
 + v \frac{\partial N_j}{\partial x} \frac{\partial N_i}{\partial y}
 \Bigg] d\Omega
 \\[5pt]
  + & \frac{\Delta t}{2} \int_{\Omega} v
 \Bigg[
   u \frac{\partial N_j}{\partial y} \frac{\partial N_i}{\partial x}
 + v \frac{\partial N_j}{\partial y} \frac{\partial N_i}{\partial y}
 \Bigg] d\Omega
 \Bigg] = 0
\end{aligned}
\end{equation}



