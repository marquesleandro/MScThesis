The Navier-Stokes equation has a strong coupling between
 the pressure field and the velocity field.
 This coupling makes it difficult to implement this
 equation computationally. The Decoupling of pressure
 and velocity fields is possible by using the
 \textit{Vorticity-Streamfunction Formulation}.
 For this, we will replace in the equation
 \ref{navier-stokes adimensional} the following vector identity:

\begin{equation}
 \textbf{c} \cdot \nabla \textbf{v}
 = 
 \nabla \left( \textbf{c} \cdot \textbf{v} \right)
 - 
 \textbf{c} \times \nabla \times \textbf{v}
\end{equation}

\medskip
\noindent
Therefore:

\begin{equation}
 \frac{\partial \textbf{v}}{\partial t} 
 + 
 \nabla \left( \textbf{c} \cdot \textbf{v} \right)
 - 
 \textbf{c} \times \nabla \times \textbf{v}
 =
 -
 \nabla p
 +
 \frac{1}{Re} \nabla^{2} \textbf{v}
 +
 \frac{1}{Fr^{2}} \textbf{g}
\end{equation}

\medskip
\noindent
Computing the curl on both sides of the above equation:

\begin{equation}
 \nabla \times \frac{\partial \textbf{v}}{\partial t} 
 + 
 \nabla \times \nabla \left( \textbf{c} \cdot \textbf{v} \right)
 - 
 \nabla \times \textbf{c} \times \nabla \times \textbf{v}
 =
 -
 \nabla \times \nabla p
 +
 \frac{1}{Re} \nabla \times \nabla^{2} \textbf{v}
 +
 \frac{1}{Fr^{2}} \nabla \times \textbf{g}
\end{equation}

\medskip
\noindent
that is:

\begin{equation}
 \frac{\partial}{\partial t} \big[ \nabla \times \textbf{v} \big]
 + 
 \nabla \times \nabla \left( \textbf{c} \cdot \textbf{v} \right)
 - 
 \nabla \times \big[ \textbf{c} \times \nabla \times \textbf{v} \big]
 =
 -
 \nabla \times \nabla p
 +
 \frac{1}{Re} \nabla^{2} \big[ \nabla \times \textbf{v} \big]
 +
 \frac{1}{Fr^{2}} \nabla \times \textbf{g}
\end{equation}

\medskip
The terms that contain the gradient operator cancel
 each other out, since the curl of gradient of a scalar is zero.
 The last term is also null because the derivatives of a constant,
 as in the case of \textbf{g}, are equal to zero. Thus, we have:

\begin{equation}
 \frac{\partial}{\partial t} \big[ \nabla \times \textbf{v} \big]
 - 
 \nabla \times \big[ \textbf{c} \times \nabla \times \textbf{v} \big]
 =
 \frac{1}{Re} \nabla^{2} \big[ \nabla \times \textbf{v} \big]
\end{equation}

\medskip
\noindent
The vector $\nabla \times \textbf{v}$ is known as
\textit{vorticity} ($w$).
Therby, the equation can be represented by:

\begin{equation} \label{vort 1}
 \frac{\partial w}{\partial t}
 - 
 \nabla \times \big[ \textbf{c} \times w \big]
 =
 \frac{1}{Re} \nabla^{2} w
\end{equation}

\medskip
\noindent
The second term of left side in 
Eq. \ref{vort 1}
can be replaced by following vectorial identity:


\begin{equation}
 \nabla \times \big[ \textbf{c} \times w \big]
 =
 -
 \textbf{c} \cdot \nabla w
 +
 w \cdot \nabla \textbf{c}
\end{equation}

\medskip
\noindent
Thus the Eq. \ref{vort 1} will be:

\begin{equation} \label{vort 2}
 \frac{\partial w}{\partial t}
 +
 \textbf{c} \cdot \nabla w
 - 
 w \cdot \nabla \textbf{c}
 =
 \frac{1}{Re} \nabla^{2} w
\end{equation}

\medskip
For two-dimensional flows, as in the case of this work,
 the vorticity is perpendicular to the velocity vector.
 Thus, the product $w \cdot \nabla \textbf{c}$ will be canceled
 as presented by Pontes and Mangiavacchi (2016) \cite{pontes2016}.
 Therefore:

\begin{equation} \label{equacao vorticidade}
 \frac{\partial w}{\partial t}
 +
 \textbf{c} \cdot \nabla w
 =
 \frac{1}{Re} \nabla^{2} w
\end{equation}

\medskip
The Eq. \ref{equacao vorticidade} is known as
 \textit{vorticity equation} for two-dimensional flows of
 a Newtonian and incompressible fluid in an Arbritary
 Lagragian-Eulerian description. For a steady and 
 two-dimensional flow of incompressible fluid,
 the velocity can be calculated from the volumetric flux.
 Thereby, the velocity is replaced by a scalar.
 Such a scalar is known as \textit{streamfunction} ($\psi$).
 The relationship between the velocity components and
 the streamfunction is presented by expanding the
 continuity equation (Eq. \ref{incompressible continuity equation}):

\begin{equation} \label{cor 1}
 \frac{\partial u}{\partial x}
 +
 \frac{\partial v}{\partial y}
 =
 0
\end{equation}
 
\medskip
The following relationship between the streamfunction and
 the velocity components can be defined so that
 Eq. \ref{cor 1} is satisfied:


\begin{equation} \label{cor 2}
\begin{aligned}
 u = \frac{\partial \psi}{\partial y}
 \qquad
 v = - \frac{\partial \psi}{\partial x}
\end{aligned}
\end{equation}

\medskip
In addition, the relationship between streamfunction
and vorticity is shown expanding the
$\nabla \times \textbf{v}$ operation
for the two-dimensional case:


\begin{equation} \label{cor 3}
 \nabla \times \textbf{v}
 = 
 \frac{\partial v}{\partial x}
 - 
 \frac{\partial u}{\partial y}
\end{equation}

\medskip
\noindent
Thus, replacing the 
Eq. \ref{cor 2} in Eq. \ref{cor 3},
we have:

\begin{equation}
 w
 =
 - 
 \frac{\partial}{\partial x} \frac{\partial v}{\partial x}
 -
 \frac{\partial}{\partial y} \frac{\partial u}{\partial y}
\end{equation}

\medskip
\noindent
that is:

\begin{equation}
 w
 = 
 -
 \nabla^{2} \psi
\end{equation}

\medskip
Therefore, the equations that govern the proposed problem
in its non-dimensional form and vorticity-streamfunction formulation
are shown below:

\begin{align}
& \frac{\partial w}{\partial t}
 +
 \textbf{c} \cdot \nabla w
 =
 \frac{1}{Re} \nabla^{2} w \label{vorticidade}
 \\[10pt] 
& \nabla^{2} \psi
 = 
 - 
 w \label{corrente} \\[10pt]
& \frac{\partial e}{\partial t}
 +
 \textbf{c} \cdot \nabla e
 =
 \frac{1}{ReSc} \nabla^{2} e \label{especie quimica}
\end{align}

\medskip
\noindent
where material velocity field \textbf{v} is calculated by:
$u = \partial \psi / \partial y$ and 
$v = - \partial \psi / \partial x$. 


